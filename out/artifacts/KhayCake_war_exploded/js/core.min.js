/* KhayCake by TheB1ackSheep, Front-End Developer 2015-05-03 */
var HOST="http://jsp.falook.me/khaycake";var sessionID="";function isInteger(a){return a?a.toString().match(/^[0-9]+$/)!==null:false}function isFloat(a){return a?(isInteger(a.toString())||a.toString().match(/^\.[0-9]+$/)||a.toString().match(/^[0-9]+\.[0-9]+$/))!==null:false}var Ajax=Ajax||{};Ajax.onError=function(a){};Ajax.encodeUrl=function(a){var b=a.split("?");if(b.length>1){a=b[0]}a=HOST+a+(sessionID?";jsessionid="+sessionID:"")+(b[1]?"?"+b[1]:"");return a};Ajax.do=function(a,b,c,d){var e=$.ajax({type:a,data:c,url:Ajax.encodeUrl(b),success:function(a){if(a.success){if(typeof d==="function")d(a)}else Ajax.onError(a);if(a.sessionId)sessionID=a.sessionId},error:function(a){if(a.sessionId)sessionID=a.sessionId;Ajax.onError(a)}})};Ajax.GET=function(a,b){Ajax.do("GET",a,null,b)};Ajax.POST=function(a,b,c){Ajax.do("POST",a,b,c)};Ajax.UPLOAD=function(a,b,c){var d=$.ajax({type:"POST",url:Ajax.encodeUrl(a),data:b,processData:false,contentType:false,success:function(a){if(a.success){if(typeof c==="function")c(a)}else Ajax.onError(a);if(a.sessionId)sessionID=a.sessionId},error:function(a){if(a.sessionId)sessionID=a.sessionId;Ajax.onError(a)}})};var Product=Product||{URL:"/product"};Product.all=function(a){Ajax.GET(this.URL,a)};Product.find=function(a,b){if(a)if(isInteger(a))Ajax.GET(this.URL+"/"+a,b);else Ajax.GET(this.URL+"?q="+a,b)};Product.byCategory=function(a,b){if(isInteger(a))Ajax.GET(this.URL+"?cat="+a,b)};Product.cupcake=function(a){Product.byCategory(1,a)};Product.crapecake=function(a){Product.byCategory(2,a)};Product.brownie=function(a){Product.byCategory(3,a)};Product.partycake=function(a){Product.byCategory(4,a)};Product.save=function(a,b){if(a&&a.serialize){var c=a.serialize();Ajax.POST(this.URL,c,b)}};Product.form=function(a){return'<div class="small-padding">'+'<form action="POST" id="form-cake">'+"<h2>"+a+"</h2>"+'<div class="row">'+'<div class="col-md-6" style="max-width: 400px">'+'<h3 class="title">ข้อมูลทั่วไป</h3>'+'<p class="subtitle">ข้อมูลทั่วไปเกี่ยวกับเค้ก</p>'+'<div class="form-group">'+'<label for="name">ชื่อเค้ก</label><input class="form-control" id="name" name="name" placeholder="คัพเค้กหน้าเป็ด, เค้กปาร์ตี้วันเกิด">'+"</div>"+'<div class="form-group">'+'<label>รายละเอียด</label><textarea rows="5" class="form-control" name="detail" id="detail"></textarea>'+"</div>"+'<div class="form-group">'+'   <label for="pictures">รูปภาพ</label><div id="pic-list"></div><input type="file" accept="image/*" multiple name="pictures" id="pictures"/>'+"</div>"+'<div class="form-group">'+'<div class="row">'+'<div class="col-sm-6">'+'<label>หน่วยนับ</label><div id="unit-container"></div>'+"</div>"+'<div class="col-sm-6">'+"<label>ชนิด</label>"+'<div id="category-container"></div>'+"</div>"+"</div>"+"</div>"+'<div class="form-group">'+'<div class="row">'+'<div class="col-sm-6">'+'<label>ต้นทุน (บาท)</label><div class="input-group"><span class="input-group-addon">&#3647;</span><input type="number" id="cost" name="cost" class="form-control"/></div>'+"</div>"+'<div class="col-sm-6">'+'<label>ราคาขายต่อหน่วย (บาท)</label><div class="input-group"><span class="input-group-addon">&#3647;</span><input type="number" id="price" name="price" class="form-control"/></div>'+"</div>"+"</div>"+"</div>"+"</div>"+'<div class="col-md-6" style="max-width: 400px">'+'<h3 class="title">ราคาพิเศษ</h3>'+'<p class="subtitle">ราคาขายเมื่อลูกค้าซื้อตามจำนวนที่กำหนด</p>'+'<div class="row" id="product_sale"></div>'+'<div class="form-group">'+'<label>&nbsp;</label><button type="button" class="btn btn-default form-control" id="add-sale">เพิ่มราคาพิเศษ</button>'+"</div>"+"</div>"+"</div>"+"</form>"+"</div>"};Product.form.sale=function(a){if(!a)a={};return'<div class="form-group"><div class="col-md-4">'+'<div class="form-group">'+'<label>จำนวนชิ้น</label><input type="number" name="qty_sale" class="form-control" value="'+(a.qty?a.qty:"")+'"/>'+"</div>"+"</div>"+'<div class="col-md-6">'+'<div class="form-group">'+"<label>ราคาขาย (บาท)</label>"+'<div class="input-group"><span class="input-group-addon">&#3647;</span><input type="number" name="price_sale" class="form-control" value="'+(a.price?a.price:"")+'"/></div>'+'</div></div><div class="col-md-2"><div class="form-group"><label>&nbsp;</label>'+"<a "+(a.id?'id="sale-'+a.id+'"':"")+' class="btn btn-default form-control"><span class="glyphicon glyphicon-trash"></span></a></div></div>'};var Unit=Unit||{URL:"/unit"};Unit.all=function(a){Ajax.GET(this.URL,a)};Unit.box=function(a){Ajax.GET(this.URL,function(b){var c='<select class="form-control" name="unit_id">"';for(var d in b.message){var e=b.message[d];c+='<option value="'+e.id+'">'+e.name+"</option>"}c+="</select>";if(typeof a==="function")a(c)})};var Category=Category||{URL:"/category"};Category.all=function(a){Ajax.GET(this.url,a)};Category.box=function(a){Ajax.GET(this.URL,function(b){var c='<select class="form-control" name="cat_id">"';for(var d in b.message){var e=b.message[d];c+='<option value="'+e.id+'">'+e.name+"</option>"}c+="</select>";if(typeof a==="function")a(c)})};